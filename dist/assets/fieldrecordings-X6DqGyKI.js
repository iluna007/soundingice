import{a as o,j as e}from"./react-V8IiPZyx.js";import{E as w}from"./eventemitter3-DMllpG5g.js";import{P as r}from"./prop-types-D0pSn4ZB.js";import{u as z}from"./wavesurfer.js-BeC7PgL-.js";import{M as N,a as S,P as T}from"./react-map-gl-BACkhBMl.js";import{a as R}from"./mapbox-gl--tciIPl5.js";import{F as E}from"./react-icons-Bl3RMTbh.js";import"./cookie-BX9QSSmL.js";import"./react-dom-b-nR2FO5.js";import"./scheduler-BNqrtbQi.js";const m=new w;class D extends w{constructor(){super(),this.data=[],this.selectedRecord=null}getAll(){return this.data}getSelectedRecord(){return this.selectedRecord}setData(a){this.data=a,this.emit("change")}setSelectedRecord(a){this.selectedRecord=a,this.emit("change")}}const c=new D;m.on("FETCH_DATA",i=>{c.setData(i)});m.on("SELECT_RECORD",i=>{c.setSelectedRecord(i)});const A=[{id:1,recordist:"Claire",date:"10/10/2025",time:"23:35:00",lat:64.03985877,lon:-138.1501049,temperature:"-35°C",conditions:"Clear",tags:"Field Recording",audioFilePath:"https://res.cloudinary.com/dw1ht0zfd/video/upload/v1739316582/Hornshund_Underwater_c7abfh.mp3",pictureFilePath:"https://res.cloudinary.com/dw1ht0zfd/image/upload/v1739055290/Yukon_River_2_fbi0r9.jpg"},{id:2,recordist:"Hanna",date:"11/10/2025",time:"00:35:00",lat:65.18846044,lon:-151.4652797,temperature:"-35°C",conditions:"Cloudy",tags:"Yukon River",audioFilePath:"https://res.cloudinary.com/dw1ht0zfd/video/upload/v1739316581/Iceberg_Calving_-_Hansbreen_Glacier_r1gewz.mp3",pictureFilePath:"https://res.cloudinary.com/dw1ht0zfd/image/upload/v1739055289/field_recording_2_xan6ng.jpg"},{id:3,recordist:"Miguel",date:"12/10/2025",time:"01:35:00",lat:63.93657,lon:-138.47639,temperature:"-35°C",conditions:"Cloudy",tags:"Klondike River",audioFilePath:"https://res.cloudinary.com/dw1ht0zfd/video/upload/v1739316581/Belcher_Glacier_knpuil.mp3",pictureFilePath:"https://res.cloudinary.com/dw1ht0zfd/image/upload/v1739055289/students_working_5_a43l75.jpg"},{id:4,recordist:"Claire",date:"13/10/2025",time:"23:35:00",lat:63.90152,lon:-137.95093,temperature:"-35°C",conditions:"Snow",tags:"Field Work",audioFilePath:"https://res.cloudinary.com/dw1ht0zfd/video/upload/v1739316581/Grant_Deane_Records_Melting_Ice_xn4mp2.mp3",pictureFilePath:"https://res.cloudinary.com/dw1ht0zfd/image/upload/v1739055290/Yukon_River_1_wsuiqa.jpg"},{id:5,recordist:"Joao",date:"14/10/2025",time:"00:35:00",lat:64.55629475,lon:-138.5183446,temperature:"-35°C",conditions:"Cloudy",tags:"Tombstone Territorial Park",audioFilePath:"https://res.cloudinary.com/dw1ht0zfd/video/upload/v1739316582/Hornshund_Underwater_c7abfh.mp3",pictureFilePath:"https://res.cloudinary.com/dw1ht0zfd/image/upload/v1739055289/Tombstone_Park_4_l7hfui.jpg"},{id:6,recordist:"Susan",date:"15/10/2025",time:"01:35:00",lat:63.90152,lon:-137.95093,temperature:"-35°C",conditions:"Rain",tags:"Interviews",audioFilePath:"https://res.cloudinary.com/dw1ht0zfd/video/upload/v1739316582/Hornshund_Underwater_c7abfh.mp3",pictureFilePath:"https://res.cloudinary.com/dw1ht0zfd/image/upload/v1739055288/field_recording_3_gulz7r.jpg"},{id:7,recordist:"Ricardo",date:"16/10/2025",time:"23:35:00",lat:64.55625,lon:-138.51835,temperature:"-35°C",conditions:"Cloudy",tags:"Tombstone Territorial Park",audioFilePath:"https://res.cloudinary.com/dw1ht0zfd/video/upload/v1739316581/Iceberg_Calving_-_Hansbreen_Glacier_r1gewz.mp3",pictureFilePath:"https://res.cloudinary.com/dw1ht0zfd/image/upload/v1739055288/Tombstone_Park_3_zieofz.jpg"},{id:8,recordist:"Andres",date:"17/10/2025",time:"00:35:00",lat:64.27131,lon:-138.72133,temperature:"-35°C",conditions:"Rain",tags:"Interviews",audioFilePath:"https://res.cloudinary.com/dw1ht0zfd/video/upload/v1739316581/Belcher_Glacier_knpuil.mp3",pictureFilePath:"https://res.cloudinary.com/dw1ht0zfd/image/upload/v1739055288/Tombstone_Park_1_crjb7h.jpg"},{id:9,recordist:"Julia",date:"18/10/2025",time:"01:35:00",lat:64.03985877,lon:-138.1501049,temperature:"-35°C",conditions:"Cloudy",tags:"Klondike River",audioFilePath:"https://res.cloudinary.com/dw1ht0zfd/video/upload/v1739316581/Grant_Deane_Records_Melting_Ice_xn4mp2.mp3",pictureFilePath:"https://res.cloudinary.com/dw1ht0zfd/image/upload/v1739055288/drilling_river_ice_ya1yvt.jpg"},{id:10,recordist:"Joao",date:"19/10/2025",time:"23:35:00",lat:64.03985877,lon:-138.1501049,temperature:"-35°C",conditions:"Snow",tags:"Klondike River",audioFilePath:"https://res.cloudinary.com/dw1ht0zfd/video/upload/v1739316581/Grant_Deane_Records_Melting_Ice_xn4mp2.mp3",pictureFilePath:"https://res.cloudinary.com/dw1ht0zfd/image/upload/v1739055293/students_working_2_ibr7vr.jpg"},{id:11,recordist:"Joao",date:"20/10/2025",time:"00:35:00",lat:64.55629475,lon:-138.5183446,temperature:"-35°C",conditions:"Clear",tags:"Field Recording",audioFilePath:"https://res.cloudinary.com/dw1ht0zfd/video/upload/v1739316581/Belcher_Glacier_knpuil.mp3",pictureFilePath:"https://res.cloudinary.com/dw1ht0zfd/image/upload/v1739055282/Yukon_River-5_faolxu.jpg"},{id:12,recordist:"Susan",date:"21/10/2025",time:"01:35:00",lat:64.55629475,lon:-138.5183446,temperature:"-35°C",conditions:"Clear",tags:"Field Recording",audioFilePath:"https://res.cloudinary.com/dw1ht0zfd/video/upload/v1739316581/Iceberg_Calving_-_Hansbreen_Glacier_r1gewz.mp3",pictureFilePath:"https://res.cloudinary.com/dw1ht0zfd/image/upload/v1739055281/Yukon_River_4_hlp5dg.jpg"},{id:13,recordist:"Ricardo",date:"22/10/2025",time:"23:35:00",lat:64.55629475,lon:-138.5183446,temperature:"-35°C",conditions:"Clear",tags:"Field Recording",audioFilePath:"https://res.cloudinary.com/dw1ht0zfd/video/upload/v1739316582/Hornshund_Underwater_c7abfh.mp3",pictureFilePath:"https://res.cloudinary.com/dw1ht0zfd/image/upload/v1739055291/Yukon_River_3_xoonfg.jpg"}],M=async()=>{try{await new Promise(a=>setTimeout(a,500));const i=A;m.emit("FETCH_DATA",i)}catch(i){console.error("Error fetching dummy data:",i)}},x=i=>{m.emit("SELECT_RECORD",i)},I=({audioUrl:i})=>{const a=o.useRef(null),l=o.useRef(null);return o.useEffect(()=>(a.current&&i&&(l.current=z.create({container:a.current,waveColor:"#ddd",progressColor:"#333",cursorColor:"#333",height:80,barWidth:2}),l.current.load(i)),()=>{l.current&&l.current.destroy()}),[i]),e.jsx("div",{ref:a})},b=({record:i})=>{const[a,l]=o.useState(!0);return o.useEffect(()=>{l(!0)},[i]),e.jsxs("div",{className:"recording-card",id:`record-${i.id}`,onClick:()=>l(!1),style:{cursor:"pointer"},children:[e.jsx("img",{src:i.pictureFilePath,alt:`Picture for ${i.recordist}`,className:"recording-image",loading:"lazy",onError:p=>{p.target.src="https://dummyimage.com/300x300/cccccc/ffffff&text=No+Image"}}),a&&e.jsxs("div",{className:"preview-info",children:[e.jsx(I,{audioUrl:i.audioFilePath}),e.jsxs("p",{className:"recording-id",children:["ID: ",i.id]})]}),!a&&e.jsxs("div",{className:"recording-details",children:[e.jsx("h3",{children:i.id}),e.jsxs("p",{children:[e.jsx("strong",{children:"Date:"})," ",i.date]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Time:"})," ",i.time]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Location:"})," Lat: ",i.lat,", Lon: ",i.lon]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Conditions:"})," ",i.conditions]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Duration:"})," ",i.Duration||i.duration]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Key Words:"})," ",i.tags||i["Key Words"]]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Recordist:"})," ",i.recordist]}),e.jsxs("audio",{controls:!0,autoPlay:!0,children:[e.jsx("source",{src:i.audioFilePath,type:"audio/mpeg"}),"Your browser does not support the audio element."]})]})]})};b.propTypes={record:r.shape({id:r.oneOfType([r.string,r.number]).isRequired,pictureFilePath:r.string.isRequired,audioFilePath:r.string.isRequired,recordist:r.string.isRequired,date:r.string.isRequired,time:r.string.isRequired,lat:r.oneOfType([r.string,r.number]).isRequired,lon:r.oneOfType([r.string,r.number]).isRequired,conditions:r.string.isRequired,Duration:r.string,duration:r.string,tags:r.string,"Key Words":r.string}).isRequired};R.accessToken="pk.eyJ1IjoiaWtlcmx1bmEiLCJhIjoiY203NjMwZHptMHAzaDJrcXlrbnNuMHJlZiJ9.hkoRlM6gQ-BflcGjpI40GA";const H=()=>{const[i,a]=o.useState({latitude:64.03985877,longitude:-138.1501049,zoom:3,width:"100%",height:"100%"}),[l,p]=o.useState(c.getAll()),[s,g]=o.useState(c.getSelectedRecord()),h=o.useRef(null);o.useEffect(()=>{const d=()=>{p(c.getAll()),g(c.getSelectedRecord())};return c.on("change",d),()=>c.off("change",d)},[]);const f=d=>{x(d)};return e.jsxs(N,{ref:h,...i,mapStyle:"mapbox://styles/ikerluna/cm2dk18gv007l01ph2anbepkk",mapboxApiAccessToken:R.accessToken,onMove:d=>a(d.viewState),onError:d=>console.error("Mapbox error:",d),interactive:!0,children:[l.map(d=>e.jsx(S,{latitude:d.lat,longitude:d.lon,children:e.jsx("div",{onClick:()=>f(d),style:{cursor:"pointer"},children:e.jsx(E,{size:30,color:s&&d.id===s.id?"black":"grey"})})},d.id)),s&&e.jsx(T,{className:"custom-popup",latitude:s.lat,longitude:s.lon,closeButton:!0,closeOnClick:!1,onClose:()=>x(null),offsetTop:-10,children:e.jsxs("div",{children:[e.jsxs("p",{children:["ID: ",s.id]}),e.jsxs("audio",{controls:!0,autoPlay:!0,children:[e.jsx("source",{src:s.soundFilePath,type:"audio/mpeg"}),"Your browser does not support the audio element."]})]})})]})},U=()=>{const[i,a]=o.useState([]),[l,p]=o.useState(!0),[s,g]=o.useState({recordist:"",tags:"",conditions:"",date:""}),[h,f]=o.useState([]),[d,_]=o.useState(!1),v=o.useCallback(()=>{const t=c.getAll()||[];a(t),p(!1)},[]);o.useEffect(()=>(M(),c.on("change",v),()=>{c.off("change",v)}),[v]);const C=[...new Set(i.map(t=>t.recordist))],y=[...new Set(i.flatMap(t=>t.tags?t.tags.split(",").map(n=>n.trim()):[]))],P=[...new Set(i.map(t=>t.conditions))],k=[...new Set(i.map(t=>t.date))];o.useEffect(()=>{let t=i;s.recordist&&(t=t.filter(n=>n.recordist===s.recordist)),s.tags&&(t=t.filter(n=>n.tags&&n.tags.toLowerCase().includes(s.tags.toLowerCase()))),s.conditions&&(t=t.filter(n=>n.conditions===s.conditions)),s.date&&(t=t.filter(n=>n.date===s.date)),f(t)},[i,s]);const u=(t,n)=>{g(j=>({...j,[t]:j[t]===n?"":n}))};o.useEffect(()=>{const t=()=>{window.pageYOffset>300?_(!0):_(!1)};return window.addEventListener("scroll",t),()=>window.removeEventListener("scroll",t)},[]);const F=()=>{window.scrollTo({top:0,behavior:"smooth"})};return e.jsxs("div",{className:"field-recordings-page",children:[l?e.jsx("p",{children:"loading..."}):e.jsxs("div",{className:"field-recordings-layout",children:[e.jsxs("div",{className:"filter-sidebar",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("h3",{children:"Recordist"}),e.jsxs("div",{className:"buttons",children:[e.jsx("button",{className:`filter-btn ${s.recordist?"":"active"}`,onClick:()=>u("recordist",""),children:"All"}),C.map(t=>e.jsx("button",{className:`filter-btn ${s.recordist===t?"active":""}`,onClick:()=>u("recordist",t),children:t},t))]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("h3",{children:"Key Words"}),e.jsxs("div",{className:"buttons",children:[e.jsx("button",{className:`filter-btn ${s.tags?"":"active"}`,onClick:()=>u("tags",""),children:"All"}),y.map(t=>e.jsx("button",{className:`filter-btn ${s.tags===t?"active":""}`,onClick:()=>u("tags",t),children:t},t))]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("h3",{children:"Conditions"}),e.jsxs("div",{className:"buttons",children:[e.jsx("button",{className:`filter-btn ${s.conditions?"":"active"}`,onClick:()=>u("conditions",""),children:"All"}),P.map(t=>e.jsx("button",{className:`filter-btn ${s.conditions===t?"active":""}`,onClick:()=>u("conditions",t),children:t},t))]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("h3",{children:"Date"}),e.jsxs("div",{className:"buttons",children:[e.jsx("button",{className:`filter-btn ${s.date?"":"active"}`,onClick:()=>u("date",""),children:"All"}),k.map(t=>e.jsx("button",{className:`filter-btn ${s.date===t?"active":""}`,onClick:()=>u("date",t),children:t},t))]})]})]}),e.jsx("div",{className:"recording-list",children:h.length>0?h.map(t=>e.jsx(b,{record:t},t.id)):e.jsx("p",{children:"No recordings available."})}),e.jsx("div",{className:"map-container",children:e.jsx(H,{})})]}),e.jsx("button",{className:`scroll-to-top ${d?"show":""}`,onClick:F,"aria-label":"Scroll to top",children:"↑"})]})};export{U as default};
